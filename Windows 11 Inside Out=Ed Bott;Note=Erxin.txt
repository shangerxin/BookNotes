Windows 11 Inside Out=Ed Bott;Note=Erxin


# Windows Essentials
- Microsoft’s developers receive unprecedented levels of feedback that shape the development effort in real time. That feedback comes from automated data collection (known formally as diagnostics and informally as telemetry) as well as from a Feedback Hub app

- Click the Minimize icon in the upper-right corner of any window to display this list of window arrangement options. 


# Setting up a new windows 11 pc 
- You can still buy a physical copy of Windows 11 in a package that includes installation files on a bootable USB flash drive or a DVD. 

- Download Windows 11 page (https://aka.ms/downloadwindows11), which supports three options

Windows 11 Installation Assistant This simple tool is designed for upgrading PCs that are running a supported version of Windows 10

Create Windows 11 Installation Media Use this option to download the Windows 11 Media Creation Tool, which helps you create a bootable USB flash drive 

Download Windows 11 Disk Image (ISO) If you know how to work with ISO files, this option is incredibly versatile, allowing you to access the files as a virtual DVD drive on any device or to copy them

-  detailed instructions for all these scenarios, see https://bit.ly/deploy-single-usb-drive.

- latest version at https://rufus.ie/. It allows precise control over partitioning, formatting, and copying installation files to a USB flash drive.

- hardwares 

Windows 11, look for it on one of the following lists:

Supported AMD Processors at https://bit.ly/win11-compatible-cpu-amd

Supported Intel Processors at https://bit.ly/win11-compatible-cpu-intel

Supported Qualcomm Processors at https://bit.ly/win11-compatible-cpu-qualcomm

- licenses 

Windows 11 supports the following license types:

OEM An OEM (original equipment manufacturer) license is one that’s included with a new computer

Full A full license is sold directly to retail customers as an electronic distribution or a packaged product.

Volume Volume licenses for Windows are sold in bulk to corporate etc.

Cloud Businesses can purchase upgrades to Windows 10 or Windows 11 Enterprise using a subscription option (E3 or E5); 

- Windows 10/11 subscription activation, visit https://bit.ly/win11-subscription.

- command with a switch that produces verbose output: slmgr /dlv. Use slmgr /ipk <product_key> to install the 25-character product key you provide following that switch. The /upk switch uninstalls the current product key, and the /cpky switch removes the product key from the registry 

- Windows 11 on a Mac, try Parallels, available at https://parallels.com. For other operating systems, check out VMware (http://bit.ly/vmware-personal)

- edit boot configuration from commandline 

bcdedit /set {current} description “Menu description goes here” 



# Using Windows 11
- customizing start menu 

To open the Start menu, click the Windows logo—the leftmost button in the center of the taskbar—or press the Windows key. In Windows 11, Start is divided into a series of horizontal regions

- customize task bar 

settings > personalization > taskbar 

- customize windows 11 start layout 

Start layout customizations are configured with LayoutModification.json and, optionally, LayoutModification.xml:

LayoutModification.json provides full support for app pins

LayoutModification.json file and adding it to an image, in the %localappdata%\Microsoft\Windows\Shell folder.

reference: https://learn.microsoft.com/en-us/windows-hardware/customize/desktop/customize-the-windows-11-start-menu

- open quick setting with win + a 

- customize notification 

- quickly snap a window into one of several predetermined layouts by pointing and clicking—no dragging and dropping required. To get started, hover the mouse pointer over the maximize button on the window you want to rearrange

-  Microsoft PowerToys package. Full documentation, including a download link, is available at https://learn.microsoft.com/windows/powertoys.

- hold down the Alt key. Hold down Alt and tap the Tab key to cycle (left to right, top to bottom) through all open windows.

- osk keyboard, win+r type osk 

- customize color 
- customize lock and sign in screen 
- By default, Windows 11 does not configure a screen saver, although it includes a handful of old favorites.

- assign sound to system event Settings > Personalization > Themes > Sounds 

- theme, Custom theme settings are saved as a plain text file with the .theme file name extension in your %LocalAppData%\Microsoft\Windows\Themes folder. (Visit https://bit.ly/windows-theme-format 

you can find a full listing on the web at https://www.microsoft.com/store/collections/windowsthemes. 

- icon 

displays the selection of alternative icons from the file C:\Windows\System32\Imageres.dll. (Be sure to use the horizontal scroll bar to see them all.) If none of these suits you, try browsing to C:\Windows\System32\Shell32.dll.

- clear types works 

ClearType works, visit Microsoft’s ClearType site at https://bit.ly/ClearTypeInfo.


# Install and configure apps 
- Progressive Web Apps (PWAs) that function like native apps. You can find some PWAs packaged for delivery through the Store; 

- Windows App SDK and the Windows UI Library, see the developer-focused documentation at https://docs.microsoft.com/windows/apps/windows-app-sdk and https://docs.microsoft.com/windows/apps/winui.

- “Overview of Progressive Web Apps (PWAs)” at https://bit.ly/edge-pwa-overview. For more on how PWAs work, see “The user experience of PWAs” at https://bit.ly/edge-pwa-ux

- winget, automatic install with windows 11 

Windows Package Manager Community Repository, at https://github.com/microsoft/winget-pkgs. Although this capability is primarily of interest to developers who are comfortable with the corresponding package manager in Linux distributions, i

$ winget install --id Microsoft.Powershell --source winget.

Winget, see https://learn.microsoft.com/windows/package-manager/.

- manage startup apps 

Run key (machine) Apps listed in the registry’s HKLM\Software\Microsoft\Windows\CurrentVersion\Run key are available at startup to all users. For 32-bit apps, this data might be stored in HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Run.

Run key (user) Apps listed in the HKCU\Software\Microsoft\Windows\CurrentVersion\Run key run when the current user signs in. A similar subkey, HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows\Run, can also be used.

Load value Apps listed in the Load value of the registry key HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows run when any user signs in.

Scheduled tasks The Windows Task Scheduler can specify tasks that run at startup. In addition, an administrator can set up tasks for your computer to run at startup that are not available for you to change or delete.

RunOnce and RunOnceEx keys This group of registry keys identifies apps that run only once, at startup. This configuration is typically part of the initial setup for an app. These keys can be assigned to a specific user account or to the machine:

HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce

HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnceEx

HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce

HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnceEx

RunServices and RunServicesOnce keys As their names suggest, these rarely used keys can control the automatic startup of services. They can be assigned to a specific user account or to a computer.

Winlogon key The Winlogon key controls actions that occur when you sign in to a computer running Windows. Most of these actions are under the control of the operating system, but you can also add custom actions here. The HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit and HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell subkeys can automatically launch apps.

Group Policy The Group Policy console includes two policies (one in Computer Configuration > Administrative Templates > System > Logon and one in the comparable User Configuration folder) called Run These Programs At User Logon that specify a list of apps to be run whenever any user signs in.

Policies\Explorer\Run keys Using policy settings to specify startup apps, as described in the previous paragraph, creates corresponding values in either of two registry keys: HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run or HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run.

Logon scripts Logon scripts, which run automatically at startup, can open other apps. Logon scripts are specified in Group Policy in Computer Configuration > Windows Settings > Scripts (Startup/Shutdown) and User Configuration > Windows Settings > Scripts (Logon/Logoff).

- autorun, system internals 

Microsoft’s Windows Sysinternals collection. Autoruns, which you can download from https://bit.ly/autoruns,



# Using and managing built-in windows apps 
- To list all system apps, use this PowerShell command:

Click here to view code image

Get-AppxPackage -PackageTypeFilter Main | ? { $_.SignatureKind -eq “System” } | Sort Name | Format-Table Name, InstallLocation

- try visiting https://support.microsoft.com/todo, which contains an assortment of tips, tricks, and troubleshooting advice.




# Using microsoft edge 
- change default browser,  default settings—for example, assigning particular browsers to particular web protocols—see “Setting default programs and file-type associations”

- To check the status for all releases in the Stable channel (including scheduled releases for the next several months), go to https://docs.microsoft.com/DeployEdge/microsoft-edge-release-schedule.

- Use the edge://syntax for quick shortcuts

Google’s Chrome browser allows you to access a plethora of options using the chrome://prefix

- browser extensions 




# Managing local and cloud storage 
- Running Disk Management
To run Disk Management, type diskmgmt.msc at a command prompt; as an alternative, you can press Windows key+X

- Convert an MBR disk to GPT

In earlier versions of Windows, you could convert a disk from MBR to GPT (or vice versa) only before a disk had been partitioned for the first time 

MBR, master root record, GPT, guid partition table 

- EXFAT, FAT32  


umes (“storage spaces”) within those pools.

- OneDrive for Business offers a similar web-based view

- convert fat32 to ntfs 

essential syntax is

$ convert d: /fs:ntfs

- Use BitLocker drive encryption to wipe a drive clean

- Attach VHD in Disk Management. Then type or browse to the location of the VHD or VHDX file



# Managing windows 11 
# Mastering file explorer 
- Zoom through File Explorer with keyboard shortcuts

You can find File Explorer in various places in Windows 11, but if you’re handy with the keyboard,

- Windows so that it always shows the full menus. 

Reg.exe add "HKCU\Software\Classes\CLSID\{86CA1AA0-34AA-4E8B-A509-50C905BAE2A2}\InprocServer32" /f /ve

- Customize folder templates

Not sure what folder “type” you’re in? Right-click a blank space in the folder and then click Show More Options > Customize This Folder. On the Customize tab of the Properties dialo

- Using compressed (zipped) folders
Depending on the file type, you can dramatically reduce the amount of disk space used by one or more files by compressing those files into a zipped folder. You can also combine multiple files into a single Zip file

- It’s organized into three subfolders, named Local, LocalLow, and Roaming. The Roaming folder (which is also accessible via the environment variable %AppData%) is for data that’s made available to a roaming profile (a profile stored on a network server; the server makes the profile available to any network computer where the user signs in). The Local folder (which is also accessible via the system variable %LocalAppData%) is for data that should not roam. This location includes the Temp folder (accessible with the environment variable %Temp%), where Windows and apps create files that are strictly for temporary use. The LocalLow folder is used by applications that run at a lower integrity level, including some games, pages running in Internet Explorer mode 

- relocate data folder 

Open your user profile folder by starting at This PC, navigating to C:\Users, and then double-clicking your profile name. Alternatively, enter %UserProfile% in the address bar.

Right-click a folder you want to relocate and choose Properties. (Or select the folder, and then click Properties on the Home tab.)

On the Location tab, enter the address you want to relocate the folder top

- Advanced queries support the following types of search parameters, which can be combined using search operators:

File contents Keywords, phrases, numbers, and text strings

Kinds of items Folders, documents, pictures, music, and so on

Data stores Specific locations in the Windows file system containing indexed items

File properties Size, date, tags, and so on


type:="Microsoft Word Document"

search values
modified:9/29/22
modified:9/1/2022..10/31/2022

You can also use Boolean operators (AND, OR, and NOT) and parentheses to combine criteria. 



#  managing user accounts, passwords and credentials 
- windows hello 

trusted device that you can unlock using biometric hardware or a device-specific PIN

- windows pin 

To sign in using a PIN, enter the numbers on your keyboard. Note that keypresses in the numeric keypad area of the keyboard register as numbers while you type in the PIN box on the sign-in screen

- picture password 

To sign in using a PIN, enter the numbers on your keyboard. Note that keypresses in the numeric keypad area of the keyboard register as numbers while you type in the PIN box on the sign-in screen

- What are ACLs?

Each folder and each file on an NTFS-formatted volume has an ACL (also known as DACL, for discretionary access control list, and commonly called NTFS permissions). An ACL comprises an access control entry (ACE) for each user who is allowed access to the folder or file. 




# configuring windows networks 
- The solution is IPv6, which uses 128-bit addresses and therefore has a maximum address space of 3.4 × 1038 addresses, which we are confident is enough to last for the next few generations of internet users. 

- DHCP This is the default configuration for Windows 11, and in fact, most other devices. A DHCP server maintains a pool of IP addresses for use by network devices

- Alternate IP Configuration Use this feature to specify multiple IPv4 addresses for a single network connection

- Automatic Private IP Addressing (APIPA) When no DHCP server is available, Windows automatically assigns an IPv4 address in a specific private IP range.


- easier alternative is to use any of several websites dedicated to this task:

https://whatismyip.com

https://myexternalip.com (IPv4 only)

https://whatismypublicip.com (IPv4 only)

https://icanhazip.com (IPv6 only)

- wireless security 

Wired Equivalent Privacy (WEP) WEP is a first-generation scheme that dates back before the turn of the century

Wi-Fi Protected Access (WPA) WPA is an early version of the encryption scheme that has since been replaced by both WPA2 and WPA3. I

Wi-Fi Protected Access 2 (WPA2) Based on the 802.11i standard, WPA2 provides a strong protection for consumer-grade wireless networks.

Wi-Fi Protected Access 3 (WPA3) Also based on the 802.11i standard, WPA3 extends the security of WPA2.

- connect using Remote Desktop to your computer. To do this, click Remote Desktop Users on the Remote Desktop page

- Network Command Prompt window and type the executable name followed by /?.

IP Configuration Utility (Ipconfig.exe) Enables you to check the current IP configuration for your installed network adapters.

Name Server Lookup (Nslookup.exe) Provides a great way to test name resolution.

Net services commands (Net.exe) Performs a broad range of network tasks. Type net with no parameters to see a full list of available command-line options.

Network Command Shell (Netsh.exe) Displays or modifies the network configuration of a local or remote computer that’s currently running. This command-line scripting utility has a huge number of options, which are fully detailed in Help.

TCP/IP Ping (Ping.exe) Verifies IP-level connectivity to another internet address (or hostname) by sending Internet Control Message Protocol (ICMP) packets and measuring the response time in milliseconds.

TCP/IP Traceroute (Tracert.exe) Determines the path to an internet address (or hostname) and lists the time required to reach each hop. It’s useful for troubleshooting connectivity problems on specific network segments.

    + powershell 
    
$ get-command -module nettcpip, netadapter

- Ping command with no parameters, Windows sends four echo datagrams—small Internet Control Message Protocol (ICMP) packets—to the address you specify. 




# windows security and privacy 
-  Open any KB article directly

If you’re reading about a Knowledge Base article and don’t have access to a hyperlink, your best bet is to visit Microsoft’s Bing search engine (https://bing.com) and search for the article using the seven-digit number following “KB.” 


- windows update 

- User Account Control (UAC) intercedes whenever a user or an app attempts to perform a system administrative task, requiring the consent of a computer administrator before commencing what could be risky business.





# Hardware and devices 
- This core library is copied during Windows setup to a protected system folder, %SystemRoot%\System32\DriverStore. (Driver files and associated elements are stored in the FileRepository subfolder.) Anyone who signs in to the computer has Read & Execute permissions for files that are saved in that location

- DriverStore folder include Setup Information files in the %SystemRoot%\Inf folder.

- The top choice in Driver Verifier Manager creates a list of all currently installed drivers, which you can use for troubleshooting.

- Printers and print queues 

- Screen setting. The Night Light feature is based on a relatively recent scientific discovery: Blue light suppresses the secretion of melatonin, disrupting circadian rhythms and negatively affecting your sleep



# Performance and power management 
- System Information—often called by the name of its executable, Msinfo32.exe—is a techie’s paradise. It displays a wealth of configuration information

- Systeminfo
Systeminfo.exe is a command-line utility that displays information about your Windows version, BIOS, processor, memory, network configuration


- Windows Management Instrumentation (WMI) is Microsoft’s comprehensive infrastructure for automating administrative tasks on servers and desktop computers running Windows


Type wmic at a command prompt, and the utility runs in console mode, wherein you can enter commands and view output interactively. Alternatively, you can add global switches or aliases

$ wmic qfe list brief /format:htable > %temp%\hotfix.html

PowerShell WMI cmdlets, see https://bit.ly/powershell-wmi.

- Resource Monitor organizes information using tabs. The Overview tab provides charts that offer a visual snapshot of performance in real time in four areas: CPU, disk, network, and memory. 

- A service is a specialized program that performs a function to support other programs. Many services operate at a low level (by interacting directly with hardware, for example) and need to run even when no user is signed in. SCM 

- Managing services from Task Manager
Using the Services page in Task Manager, you can start and stop services and view several important aspects of the services, both running and available, on your computer.

- find powercfg /batteryreport, powercfg /energy, and powercfg /sleepstudy useful. These commands generate reports that are not available via the interactive power-management
                                  
                                  
                                  

# Troubleshooting backup and recovery 
- Getting to know throubleshooting toolkit 
- Control panel > securitty and maintaincy > problems report 

built-in troubleshooters 

- The Windows Error Reporting service runs continuously in the background, keeping track of software and driver installations (successful and otherwise) as well as crashes, hangs, and other system events that indicate a possible problem with Windows. 

- reliability monitor, Windows 11 keeps track of an enormous range of system events, which you can monitor using Event Viewer, as we describe in the following section. For a day-by-day inventory of specific events

- event viewer 

most probable cause of the Stop error. Download the tool from https://www.nirsoft.net/utils/blue_screen_view.html.

-  Startup Settings menu are of use in specialized circumstances:

Enable Debugging Use this option if you’ve installed debugging tools and want to switch into a special mode that is compatible with those tools.

Enable Boot Logging With this option enabled, Windows creates a log file that lists the names and status of all drivers loaded into memory. To view the contents of this file, look for Ntbtlog.txt in the %SystemRoot% folder. If your system is hanging because of a faulty driver, the last entry in this log file might identify the culprit.

Enable Low-Resolution Video This option starts the computer in 640-by-480 resolution using the current video driver. Use this option to recover from video problems that are caused not by a faulty driver but by incorrect settings, such as an improper resolution or refresh rate.

Disable Driver Signature Enforcement Use this option if Windows is refusing to start because you installed an unsigned user-mode driver. Windows will start normally, not in Safe Mode. (Note that you cannot disable the requirement for signed kernel-mode drivers.)

Disable Early Launch Anti-malware Protection This is one of the core security measures of Windows 11 on a UEFI-equipped machine. Unless you’re a security researcher or a driver developer, we can’t think of any reason to disable this important security check.

Disable Automatic Restart After Failure Use this option if you’re getting Stop errors (blue-screen crashes) and you want the opportunity to see the crash details on the Stop error screen instead of simply pausing there before restarting.

- command-line switches available with the Chkdsk command, type chkdsk /?. Here is a partial list of the available switches

-  including .inf and .ini. You can see the entire list at https://bit.ly/monitored-extensions. The information there is most useful for programmers and system administrators

- system backup and recovery 




# IT professionals and windows experts 
# Windows Terminal POwersheell and oterh advanced management tools 
- windows terminal 
- powershell 
- Task Scheduler
Task Scheduler is a Microsoft Management Console (MMC) snap-in that supports an extensive set of triggering and scheduling options. Scheduled tasks can run programs or scripts at specified times 

- Using Microsoft Management Console
Microsoft Management Console (MMC) is an application that hosts tools for administering computers, networks, and other system components. 

certmgr.msc     certificate
compmgmt.msc    computer management 
devmgmt.msc     device maangement 
diskmgmt.msc    disk management 
eventvwr.msc 
virtmgmt.msc 
gpedit.msc 
lusrmgr.msc 
perfmon.msc 
tpm.msc, trutsted platofrm module, display information about enables configurations 
wf.msc, windows firewall 


# Running windows in a virtual machine 
- Hyper-V (or, more accurately, the Hyper-V role) has long been a power feature in server editions of Microsoft Windows


# Using android and linux on windows 11 
- Using the Windows Subsystem for Linux
Once, not so long ago, Windows and Linux were archrivals. 


# Managing windows pcs in the enterprise 
- active directories 

Windows Server: https://www.microsoft.com/cloud-platform/windows-server

Active Directory Domain Services Overview: https://bit.ly/ADDS-overview

- Zero Touch installation architecture here: https://bit.ly/ZTI-overview. Although this documentation refers to Windows 10, the principles work just as well with Windows 11.

- Windows System Image Manager (Windows SIM) is part of the free downloadable Windows Assessment and Deployment Kit (Windows ADK).

applied both after deploying Windows 11 to a computer, or during the Out Of Box Experience (OOBE) in Windows 11 setup.

The official documentation for WSUS is at https://bit.ly/WSUS-intro. Windows Server Update Services. 

- microsoft intune, Microsoft Intune
As mentioned earlier, Intune enables administrators to perform mobile device management (MDM) and mobile application management (MAM) for their organization’s devices

A signa feature of Intune is the ability to deploy and manage apps to a variety of operating systems. 

- Setting up a kiosk device
Another common scenario in business is to set up a kiosk device—a computer that is set up to do only one thing. An office might use this computer as a check-in device for guests; a retail business could put a kiosk PC on the retail floor and allow customers to use the device’s touchscreen to view a product catalog or check prices. 

# Appendiex 
- windows insider 
- editions and licensing 